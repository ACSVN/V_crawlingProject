//Variable check status source code run
Var check_status=""

//Define variable from csv file input
Var web_name=""
Var url=""
Var class_href=""
Var class_company=""
Var class_title=""
Var class_company_address=""
Var class_company_recruiter=""
Var class_company_phone=""
Var class_info_job=""
Var class_date_period=""
Var class_industry=""
Var class_caption=""
Var class_total=""
Var replace_nxt_p=""
Var class_domain=""
Var case_display=""
Var total_click_search=""
Var class_main_office=""
Var class_remark=""

//Define variable get content
Var flag=0
Var url_web=""
Var number_pages=0
Var page_item=0

//Define variable get href in html file
Var path_href_file=""

// Open the CSV file
File "open" file="..\..\input_mynavi.csv" id="id1"

// Iterate over the file lines
for (line=2; {line}<={_FILE_LINE_COUNT}; line={line}+1) {
    // Parse the current line into comma separated values
    File parse line={line} id="id1"
    Var web_name={_FILE_PARSE_VALUE1}
    Var url={_FILE_PARSE_VALUE2}
    Var class_href={_FILE_PARSE_VALUE3}
    Var class_company={_FILE_PARSE_VALUE4}
    Var class_title={_FILE_PARSE_VALUE5}
    Var class_company_address={_FILE_PARSE_VALUE6}
    Var class_company_recruiter={_FILE_PARSE_VALUE7}
    Var class_company_phone={_FILE_PARSE_VALUE8}
    Var class_info_job={_FILE_PARSE_VALUE9}
    Var class_date_period={_FILE_PARSE_VALUE10}
    Var class_industry={_FILE_PARSE_VALUE11}
    Var class_caption={_FILE_PARSE_VALUE12}
    Var class_total={_FILE_PARSE_VALUE13}
    Var replace_nxt_p={_FILE_PARSE_VALUE14}
    Var class_domain={_FILE_PARSE_VALUE15}
    Var case_display={_FILE_PARSE_VALUE16}
    Var total_click_search={_FILE_PARSE_VALUE17}
    Var class_main_office={_FILE_PARSE_VALUE18}
    Var class_remark={_FILE_PARSE_VALUE19}
}
File "close" save="false"  id="id1"

Var index_row_empty=""
Var href_empty=""
Var found_image=0

// Open the CSV file
File "open" file="..\..\result\href_empty.csv" id="id2"
// Iterate over the file lines
for (ln=1; {ln}<{_FILE_LINE_COUNT}; ln={ln}+1) {
    // Parse the current line into comma separated values
    File parse line={ln} id="id2"
    Var index_row_empty={_FILE_PARSE_VALUE2}
    Var href_empty={_FILE_PARSE_VALUE3}
    Press "Windows+R"
    Paste "firefox"
    Press "Enter"
    Wait "1s"
    Paste {href_empty}
    Wait "5s"
    Press "Enter"

    Var name_html_file="url_empty"
    Run "..\..\src\mynavi\DeleteFileExist.java"
    Wait "2s"
    Run "savepagesource.tpr"
    Wait "2s"
    for (i=0; {i}<100; i={i}+1) {
        Compareto "completed_firefox.PNG" passrate="70" method="search2"
        if({_EXIT_CODE} > 0){
            Wait "1s"
        }else{
            Var found_image=1
            break
        }
    }
    if({found_image}==1){
        Run "..\..\src\mynavi\UpdateDataContent.java"
        Wait "5s"
        Log {check_status}
        Press "Ctrl+Shift+W"
    }
}

//Var name_html_file="url_empty"
//Run "..\..\src\mynavi\DeleteFileExist.java"

////Run "..\..\src\mynavi\GetHref.java"
//Var href_empty="ï»¿https://tenshoku.mynavi.jp/jobinfo-103350-1-19-1/?ty=0&searchId=1191020479&pageNum=3&showNo=5"
//Run "..\..\src\mynavi\SubstringHref.java"
//Log {href_sub}
//
//Press "Ctrl+T"
////Press F6
//Paste {href_sub}
//Wait "5s"
//Press "Enter"
//Run "..\..\src\mynavi\Test.java"

//// Open the CSV file
//File "open" file="..\..\result\href_empty.csv" id="id_error"
//// Iterate over the file lines
//for (ln=1; {ln}<{_FILE_LINE_COUNT}; ln={ln}+1) {
//    // Parse the current line into comma separated values
//    File parse line={ln} id="id_error"
    //
//    Var index_row_empty={_FILE_PARSE_VALUE1}
//    Var href_empty={_FILE_PARSE_VALUE2}
//    Run "..\..\src\mynavi\SubstringHref.java"
//    Wait "2s"
//    Log {href_sub}
//    Var _SERVER_CLIPBOARD_CONTENT={href_sub}
//    Log {_SERVER_CLIPBOARD_CONTENT}
//    Press Windows+r wait=1s
//    Type "chrome"
//    Press Enter wait=1s
////    Press Windows+up
//    Wait "0.5s"
//
////    Paste {href_sub}
//    Press "Ctrl+V"
//    Wait "5s"
//    Press "Enter"
//    Wait "30s"
//    Press "Ctrl+Shift+W"
////    Var name_html_file="item_empty"
////    Run "..\..\src\mynavi\DeleteFileExist.java"
////    Wait "10s"
////    Log {check_status}
////    Run "savepagesource.tpr"
////    Wait 2s
////    for (k=0; {k}<1000; k={k}+1) {
////        Compareto "completed.PNG" passrate="50" method="search2"
////        if({_EXIT_CODE} > 0){
////            Wait "1s"
////        }else{
////            Var found_image=1
////            break
////        }
////    }
////    if({found_image}==1){
////        Run "..\..\src\mynavi\Test.java"
////    }
//}
//
//File "close" save="false" id="id_error"

//Log {name_html_file}
//Log {check_status}
